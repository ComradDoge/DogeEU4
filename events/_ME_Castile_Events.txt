namespace = ME_Castile_Events

country_event = {
	id = ME_Castile_Events.1
	title = ME_Castile_Events.1.t
	desc = ME_Castile_Events.1.d
	picture = BORDER_TENSION_eventPicture

	fire_only_once = yes
	
	trigger = {
		tag = CAS
	}

	mean_time_to_happen = {
		days = 1
	}

	option = {
		name = ME_Castile_Events.1.a

		custom_tooltip = EE_castile_last_reconquista
		custom_tooltip = " "
		add_prestige_or_monarch_power = { amount = 10 }
	}
}

country_event = {
	id = ME_Castile_Events.2
	title = ME_Castile_Events.2.t
	desc = ME_Castile_Events.2.d
	picture = DIPLOMACY_eventPicture

	is_triggered_only = yes

	option = {
		name = ME_Castile_Events.2.a

		ai_chance = {
			factor = 1
		}

		set_country_flag = EE_castile_alligned_aragon
		reverse_add_opinion = {
			who = ARA
			modifier = spain_alligned_with_us
		}
		custom_tooltip = " "
		custom_tooltip = EE_SPA_OUR_ALIGNMENT_MATTERS_ARA
	}

	option = {
		name = ME_Castile_Events.2.b

		ai_chance = {
			factor = 0
		}

		set_country_flag = EE_castile_alligned_portugal
		reverse_add_opinion = {
			who = POR
			modifier = spain_alligned_with_us
		}
		custom_tooltip = " "
		custom_tooltip = EE_SPA_OUR_ALIGNMENT_MATTERS_POR
	}

	option = {
		name = ME_Castile_Events.2.c

		ai_chance = {
			factor = 0
		}

		set_country_flag = EE_castile_alligned_no_one
		add_prestige_or_monarch_power = { amount = 10 }
		add_legitimacy_or_reform_progress = { amount = 10 }
	}
}

country_event = {
	id = ME_Castile_Events.3
	title = ME_Castile_Events.3.t
	desc = ME_Castile_Events.3.d
	picture = BIG_BOOK_eventPicture

	is_triggered_only = yes

	option = {
		name = ME_Castile_Events.3.a

		ai_chance = {
			factor = 1
		}

		set_country_flag = EE_castile_educate_enrique
		custom_tooltip = EE_castile_unlock_education
	}

	option = {
		name = ME_Castile_Events.3.b

		ai_chance = {
			factor = 0
		}

		set_country_flag = EE_castile_assassinate_enrique
		custom_tooltip = EE_castile_unlock_assassination
		
	}
}

country_event = {
	id = ME_Castile_Events.4
	title = ME_Castile_Events.4.t
	desc = ME_Castile_Events.4.d
	picture = COURT_eventPicture

	is_triggered_only = yes

	option = {
		name = ME_Castile_Events.4.a

		ai_chance = {
			factor = 1
		}
		hidden_effect = {
			set_variable = {
				which = EE_spa_nobility_favors
				value = 0
			}
		}
		custom_tooltip = EE_SPA_COURT_BEGINS
		custom_tooltip = " "
		custom_tooltip = EE_SPA_LEVEL_0
		tooltip = {
			custom_tooltip = " "
			custom_tooltip = ESTATES_SEIZE_LAND_DESC
			take_estate_land_share_massive = { estate = all }
			custom_tooltip = " "
			add_legitimacy_or_reform_progress = { amount = 10 }
		}
		custom_tooltip = " "
		custom_tooltip = EE_SPA_LEVEL_1
		tooltip = {
			custom_tooltip = " "
			add_estate_loyalty = {
				estate = estate_nobles
				loyalty = 10
			}
			change_adm = 1
		}
		custom_tooltip = " "
		custom_tooltip = EE_SPA_LEVEL_2
		tooltip = {
			custom_tooltip = " "
			change_government_reform_progress = 150
			add_yearly_manpower = 1
		}
		custom_tooltip = " "
		custom_tooltip = EE_SPA_LEVEL_3
		tooltip = {
			custom_tooltip = " "
			remove_estate_privilege = EE_estate_nobles_powerful_cortes
			add_estate_influence_modifier = {
				estate = estate_nobles
				desc = EE_EST_VAL_COMPLETE_CURTAIL
				influence = -30
				duration = 18250
			}
		}

		hidden_effect = {
			country_event = { id = ME_Castile_Events.5 days = 50 }
		}
	}
}

country_event = {
	id = ME_Castile_Events.5
	title = ME_Castile_Events.5.t
	desc = ME_Castile_Events.5.d
	picture = REFORM_eventPicture

	is_triggered_only = yes

	option = {
		name = ME_Castile_Events.5.a

		ai_chance = {
			factor = 1
		}

		#set_estate_privilege = estate_nobles_tax_relief
		add_legitimacy = -10
		custom_tooltip = " "
		custom_tooltip = EE_SPA_NOBILITY_INDEBTED
		hidden_effect = {
			EE_change_variable = {
				add = 1
				which = EE_spa_nobility_favors
			}
		}
	}

	option = {
		name = ME_Castile_Events.5.b

		ai_chance = {
			factor = 1
		}
	}

	after = {
		hidden_effect = {
			country_event = { id = ME_Castile_Events.6 days = 50 }
		}
	}
}

country_event = {
	id = ME_Castile_Events.6
	title = ME_Castile_Events.6.t
	desc = ME_Castile_Events.6.d
	picture = NOBLE_ESTATE_eventPicture

	is_triggered_only = yes

	option = {
		name = ME_Castile_Events.6.a

		ai_chance = {
			factor = 1
		}
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = 10
		}
		add_stability = 1
		add_prestige = -15
		custom_tooltip = " "
		custom_tooltip = EE_SPA_SIDED_WITH_CORTES_1
		hidden_effect = {
			EE_change_variable = {
				add = 1
				which = EE_spa_nobility_favors
			}
		}
	}

	option = {
		name = ME_Castile_Events.6.b

		ai_chance = {
			factor = 1
		}
		add_yearly_manpower = 1
		add_ruler_modifier = {
			name = EE_spa_placated_strong_noble
			duration = -1
		}
		add_estate_influence_modifier = {
			estate = estate_nobles
			desc = EST_VAL_FURTHERED_SPOUSES_FAMILY_NOBLES
			influence = 15
			duration = 7300
		}
		custom_tooltip = " "
		custom_tooltip = EE_SPA_SIDED_WITH_CORTES_2
		hidden_effect = {
			EE_change_variable = {
				add = 1
				which = EE_spa_nobility_favors
			}
		}
	}

	option = {
		name = ME_Castile_Events.6.c

		ai_chance = {
			factor = 1
		}
	}

	after = {
		hidden_effect = {
			country_event = { id = ME_Castile_Events.7 days = 50 }
		}
	}
}

country_event = {
	id = ME_Castile_Events.7
	title = ME_Castile_Events.7.t
	desc = ME_Castile_Events.7.d
	picture = NOBLE_ESTATE_DEMANDS_eventPicture

	is_triggered_only = yes

	option = {
		name = ME_Castile_Events.7.a

		ai_chance = {
			factor = 1
		}

		add_years_of_income = -0.3
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = 15
		}
		custom_tooltip = EE_SPA_NOBILITY_INDEBTED
		hidden_effect = {
			EE_change_variable = {
				add = 1
				which = EE_spa_nobility_favors
			}
		}
	}

	option = {
		name = ME_Castile_Events.7.b

		ai_chance = {
			factor = 1
		}

		custom_tooltip = EE_SPA_IGNORED_NOBILITY_DEMANDS
	}

	after = {
		hidden_effect = {
			country_event = { id = ME_Castile_Events.8 days = 50 }
		}
	}
}

country_event = {
	id = ME_Castile_Events.8
	title = ME_Castile_Events.8.t
	desc = ME_Castile_Events.8.d
	picture = COURT_eventPicture

	is_triggered_only = yes

	option = {
		name = ME_Castile_Events.8.a

		ai_chance = {
			factor = 1
		}

		if = {
			limit = {
				check_variable = { 
					which = EE_spa_nobility_favors
					value = 0
				}
				NOT = {
					check_variable = { 
						which = EE_spa_nobility_favors
						value = 1
					}
				}
			}
			custom_tooltip = EE_spa_nobility_favors_level_0
			custom_tooltip = " "
			custom_tooltip = ESTATES_SEIZE_LAND_DESC
			take_estate_land_share_massive = { estate = all }
			custom_tooltip = " "
			add_legitimacy_or_reform_progress = { amount = 10 }
		}
		else_if = {
			limit = {
				check_variable = { 
					which = EE_spa_nobility_favors
					value = 1
				}
				NOT = {
					check_variable = { 
						which = EE_spa_nobility_favors
						value = 2
					}
				}
			}
			custom_tooltip = EE_spa_nobility_favors_level_1
			custom_tooltip = " "
			add_estate_loyalty = {
				estate = estate_nobles
				loyalty = 10
			}
			change_adm = 1
		}
		else_if = {
			limit = {
				check_variable = { 
					which = EE_spa_nobility_favors
					value = 2
				}
				NOT = {
					check_variable = { 
						which = EE_spa_nobility_favors
						value = 3
					}
				}
			}
			custom_tooltip = EE_spa_nobility_favors_level_2
			custom_tooltip = " "
			change_government_reform_progress = 150
			add_yearly_manpower = 1
		}
		else_if = {
			limit = {
				check_variable = { 
					which = EE_spa_nobility_favors
					value = 3
				}
			}
			custom_tooltip = EE_spa_nobility_favors_level_3
			custom_tooltip = " "
			remove_estate_privilege = EE_estate_nobles_powerful_cortes
			add_estate_influence_modifier = {
				estate = estate_nobles
				desc = EE_EST_VAL_COMPLETE_CURTAIL
				influence = -30
				duration = 18250
			}
		}
		hidden_effect = {
			set_variable = {
				which = EE_spa_nobility_favors
				value = 0
			}
		}
	}
}

country_event = { #Administration Help
	id = ME_Castile_Events.9
	title = ME_Castile_Events.9.t
	desc = ME_Castile_Events.9.d
	picture = CITY_VIEW_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					is_capital = no
				}
				save_event_target_as = target_province
			}
		}
	}

	option = {
		name = ME_Castile_Events.9.a

		ai_chance = {
			factor = 1
		}

		change_heir_adm = 2
		random_owned_province = {
			add_province_modifier = {
				name = EE_spa_enrique_help
				duration = 7300
			}
		}
		custom_tooltip = EE_SPA_EDUCATION_CONTINUES
		hidden_effect = {
			country_event = { id = ME_Castile_Events.11 days = 50 }
		}
	}
}

country_event = { #Foreign Court
	id = ME_Castile_Events.10
	title = ME_Castile_Events.10.t
	desc = ME_Castile_Events.10.d
	picture = CULTURE_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			random_neighbor_country = {
				save_event_target_as = EE_enrique_education_country
			}
		}
	}

	option = {
		name = ME_Castile_Events.10.a

		ai_chance = {
			factor = 1
		}

		change_heir_adm = 2
		event_target:EE_enrique_education_country = {
			reverse_add_opinion = {
				who = ROOT
   				modifier = spain_heir_visited_court
			}
		}
		custom_tooltip = EE_SPA_EDUCATION_CONTINUES

		hidden_effect = {
			country_event = { id = ME_Castile_Events.11 days = 50 }
		}
	}
}

country_event = { #A Military Education
	id = ME_Castile_Events.11
	title = ME_Castile_Events.11.t
	desc = ME_Castile_Events.11.d
	picture = LAND_MILITARY_eventPicture

	is_triggered_only = yes

	option = { #Send him hunting
		name = ME_Castile_Events.11.a

		ai_chance = {
			factor = 1
		}
		custom_tooltip = EE_SPA_MAY_KILL_HEIR
		hidden_effect = {
			random_list = {
                20 = { #Enrique dies
					set_country_flag = EE_spa_enrique_mugged
                }
                80 = { #Good Education outcome
                    set_country_flag = EE_spa_enrique_good
                }
            }
			country_event = { id = ME_Castile_Events.12 days = 50 }
		}
		
	}

	option = { #Send a general to educate him
		name = ME_Castile_Events.11.b

		ai_chance = {
			factor = 1
		}
		custom_tooltip = EE_SPA_SAFE_OPTION
		hidden_effect = {
			country_event = { id = ME_Castile_Events.16 days = 50 }
		}
	}
}

country_event = { #Hunting Outcome
	id = ME_Castile_Events.12
	title = ME_Castile_Events.12.t
	desc = {
		trigger = {
			has_country_flag = EE_spa_enrique_mugged
		}
		desc = ME_Castile_Events.12.d.mugged
	}
	desc = {
		trigger = {
			has_country_flag = EE_spa_enrique_good
		}
		desc = ME_Castile_Events.12.d.safe
	}
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes

	option = {
		name = ME_Castile_Events.12.a

		trigger = {
			has_country_flag = EE_spa_enrique_mugged
		}

		ai_chance = {
			factor = 1
		}

		kill_heir = { allow_new_heir = no }
	}

	option = {
		name = ME_Castile_Events.12.b

		trigger = {
			has_country_flag = EE_spa_enrique_good
		}

		change_heir_mil = 3
			country_event = { id = ME_Castile_Events.13 days = 50 }
			add_years_of_income = 0.25
	}
}

country_event = { #Diplo education
	id = ME_Castile_Events.13
	title = ME_Castile_Events.13.t
	desc = ME_Castile_Events.13.d
	picture = MERCHANTS_TALKING_eventPicture

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					has_port = yes
				}
				save_event_target_as = port_province
			}
		}
	}

	option = { #Send him on a ship
		name = ME_Castile_Events.13.a

		ai_chance = {
			factor = 1
		}
		custom_tooltip = EE_SPA_MAY_KILL_HEIR
		hidden_effect = {
			random_list = {
                20 = { #Enrique dies
					set_country_flag = EE_spa_enrique_mugged_diplo
                }
                80 = { #Good Education outcome
                    set_country_flag = EE_spa_enrique_good_diplo
                }
            }
			country_event = { id = ME_Castile_Events.14 days = 50 }
		}
	}

	option = { #Dip advisor
		name = ME_Castile_Events.13.b

		ai_chance = {
			factor = 1
		}
		custom_tooltip = EE_SPA_SAFE_OPTION
		hidden_effect = {
			country_event = { id = ME_Castile_Events.17 days = 50 }
		}
	}
}

country_event = { #Ship outcome
	id = ME_Castile_Events.14
	title = ME_Castile_Events.14.t
	desc = {
		trigger = {
			has_country_flag = EE_spa_enrique_mugged_diplo
		}
		desc = ME_Castile_Events.14.d.mugged_diplo
	}
	desc = {
		trigger = {
			has_country_flag = EE_spa_enrique_good_diplo
		}
		desc = ME_Castile_Events.14.d.safe_diplo
	}
	picture = HARBOUR_eventPicture

	is_triggered_only = yes

	option = {
		name = ME_Castile_Events.14.a

		trigger = {
			has_country_flag = EE_spa_enrique_mugged_diplo
		}

		ai_chance = {
			factor = 1
		}

		kill_heir = { allow_new_heir = no }
	}

	option = {
		name = ME_Castile_Events.14.b

		trigger = {
			has_country_flag = EE_spa_enrique_good_diplo
		}

		change_heir_dip = 3
		country_event = { id = ME_Castile_Events.15 days = 50 }
		add_yearly_sailors = 0.5
	}
}

country_event = { #End of Education
	id = ME_Castile_Events.15
	title = ME_Castile_Events.15.t
	desc = ME_Castile_Events.15.d
	picture = BIG_BOOK_eventPicture

	is_triggered_only = yes

	option = {
		name = ME_Castile_Events.15.a

		ai_chance = {
			factor = 1
		}
		
		custom_tooltip = EE_SPA_NO_MORE_EDUCATION
	}
}

country_event = { #Advisor Military
	id = ME_Castile_Events.16
	title = c
	desc = ME_Castile_Events.16.d
	picture = WESTERNIZATION_eventPicture

	is_triggered_only = yes

	option = { #Send him hunting
		name = ME_Castile_Events.16.a

		ai_chance = {
			factor = 1
		}

		change_heir_mil = 2
		country_event = { id = ME_Castile_Events.13 days = 50 }
	}
}

country_event = { #Advisor Diplo
	id = ME_Castile_Events.17
	title = ME_Castile_Events.17.t
	desc = ME_Castile_Events.17.d
	picture = SHIP_SAILING_eventPicture

	is_triggered_only = yes

	option = { #Send him hunting
		name = ME_Castile_Events.17.a

		ai_chance = {
			factor = 1
		}

		change_heir_dip = 2
		country_event = { id = ME_Castile_Events.15 days = 50 }
	}
}

country_event = { #Plan Assassination
	id = ME_Castile_Events.18
	title = ME_Castile_Events.18.t
	desc = ME_Castile_Events.18.d
	picture = SPY_eventPicture

	is_triggered_only = yes

	option = { #Hunting "Accident"
		name = ME_Castile_Events.18.a

		ai_chance = {
			factor = 1
		}

		country_event = {
			id = ME_Castile_Events.56
			days = 30
		}
	}

	option = { #Kill him on the border and blame someone else
		name = ME_Castile_Events.18.b

		ai_chance = {
			factor = 1
		}

		country_event = {
			id = ME_Castile_Events.57
			days = 30
		}
	}
	
	option = { #Kill him and blame nobles
		name = ME_Castile_Events.18.c

		ai_chance = {
			factor = 1
		}

		country_event = {
			id = ME_Castile_Events.59
			days = 30
		}
	}

	after = {
		if = {
			limit = {
				spymaster = 1
			}
			random = {
				chance = 80

				set_country_flag = ee_spa_assassination_success
			}
		}
		else = {
			random = {
				chance = 65

				set_country_flag = ee_spa_assassination_success
			}
		}
	}
}

country_event = { #The Crusader Forces
	id = ME_Castile_Events.19
	title = ME_Castile_Events.19.t
	desc = ME_Castile_Events.19.d
	picture = MILITARY_CAMP_eventPicture

	is_triggered_only = yes

	option = { #
		name = ME_Castile_Events.19.a

		ai_chance = {
			factor = 100
		}
		add_country_modifier = {
			name = EE_spa_naval_reconquista
			duration = 7300
		}
	}

	option = { #
		name = ME_Castile_Events.19.b

		ai_chance = {
			factor = 20
		}
		add_country_modifier = {
			name = EE_spa_army_reconquista
			duration = 7300
		}
	}
}

country_event = { #Remnants of Granada
	id = ME_Castile_Events.20
	title = ME_Castile_Events.20.t
	desc = ME_Castile_Events.20.d
	picture = CITY_VIEW_eventPicture

	is_triggered_only = yes

	option = { #Expel the Andalusians
		name = ME_Castile_Events.20.a

		ai_chance = {
			factor = 100
		}
		every_owned_province = {
			limit = {
				is_core = GRA
			}
			change_religion = ROOT
			remove_core = GRA
		}
	}

	option = { #Remove Nationalism
		name = ME_Castile_Events.20.b

		ai_chance = {
			factor = 20
		}

		every_owned_province = {
			limit = {
				is_core = GRA
			}
			add_nationalism = -15
		}

		ME_distribute_development = {
			type = production
			amount = 5
			limit = "area = upper_andalucia_area"
		}
	}
}

country_event = { #Landing in Africa
	id = ME_Castile_Events.21
	title = ME_Castile_Events.21.t
	desc = ME_Castile_Events.21.d
	picture = SIEGE_eventPicture

	is_triggered_only = yes

	option = { #Establish a vassal
		name = ME_Castile_Events.21.a

		ai_chance = {
			factor = 0
		}
		custom_tooltip = EE_SPA_GIVE_NORTH_AFRICA_TO_VASSAL
		hidden_effect = {
			every_owned_province = { #Tag not implemented yet
				limit = {
					region = maghreb_region
				}
				cede_province = MGB
				add_core = MGB
			}
			vassalize = MGB
			MGB = {
				add_country_modifier = {
					name = EE_spa_iberian_vassal
					duration = -1
				}
			}
		}
	}

	option = { #Convert them
		name = ME_Castile_Events.21.b

		ai_chance = {
			factor = 100
		}

		custom_tooltip = EE_SPA_GIVE_MISSIONARY_BUFFS_IN_AFRICA
		hidden_effect = {
			every_owned_province = {
				limit = {
					region = maghreb_region
				}
				add_province_modifier = {
					name = EE_spa_castilian_conversion
					duration = 7300
				}
				remove_province_modifier = religious_zeal_at_conv
			}
		}
		set_country_flag = ee_spa_north_africa_conversion
		add_papal_influence = 10
	}

	option = { #Cortez Vassal
		name = ME_Castile_Events.21.c

		ai_chance = {
			factor = 20
		}

		highlight = yes
		trigger = {
			has_leader = "Hernan Cortez"
			
		}
		kill_leader = {
			type = "Hernan Cortez"
		}
		custom_tooltip = EE_SPA_GIVE_NORTH_AFRICA_TO_VASSAL
		hidden_effect = {
			every_owned_province = { #Tag not implemented yet
				limit = {
					region = maghreb_region
				}
				cede_province = MGB
				add_core = MGB
			}
			vassalize = MGB
			MGB = {
				add_country_modifier = {
					name = EE_spa_iberian_vassal
					duration = -1
				}
			}
		}
		MGB = {
			define_ruler = {
				name = "Hernan"
				dynasty = "Cortez"
				culture = castillian
				religion = catholic
				adm = 3
				dip = 3
				mil = 6
				age = 20
				claim = 95
			}
		}
	}
}

country_event = { #Fall of Tunis
	id = ME_Castile_Events.22
	title = ME_Castile_Events.22.t
	desc = ME_Castile_Events.22.d
	picture = CITY_VIEW_eventPicture

	is_triggered_only = yes

	option = { #They raided us for far too long. Revenge
		name = ME_Castile_Events.22.a

		ai_chance = {
			factor = 100
		}
		
		341 = {
			add_devastation = 50
		}

		ME_distribute_development = {
			type = tax
			amount = 5
		}

		add_years_of_income = 1
	}

	option = { #Convert them
		name = ME_Castile_Events.22.b

		ai_chance = {
			factor = 20
		}

		341 = {
			add_base_manpower = 1
			add_base_production = 2
		}

		add_or_upgrade_tax_building = yes
		add_or_upgrade_production_building = yes
	}
}

country_event = { #Algerian Bases
	id = ME_Castile_Events.23
	title = ME_Castile_Events.23.t
	desc = ME_Castile_Events.23.d
	picture = CONQUEST_eventPicture

	is_triggered_only = yes

	option = { #They raided us for far too long. Revenge
		name = ME_Castile_Events.23.a

		ai_chance = {
			factor = 100
		}
		
		add_prestige_or_monarch_power = { amount = 15 }
		add_years_of_income = 0.5
		add_country_modifier = {
			name = EE_spa_fall_of_algeria
			duration = 7300
		}
		
	}

	option = { #Convert them
		name = ME_Castile_Events.23.b

		ai_chance = {
			factor = 20
		}
		
		highlight = yes
		trigger = {
			MGB = {
				is_subject_of = ROOT
			}
		}

		MGB = {
			add_liberty_desire = -20
		}

		ME_distribute_development = {
			type = manpower
			amount = 5
			limit = "has_fort_building_trigger = true"
		}
	}
}

country_event = { #Fate of Maghreb
	id = ME_Castile_Events.24
	title = ME_Castile_Events.24.t
	desc = ME_Castile_Events.24.d
	picture = BATTLE_eventPicture

	is_triggered_only = yes

	option = { #Colonize the provinces for Sahara
		name = ME_Castile_Events.24.a

		ai_chance = {
			factor = 100
		}
		
		if = {
			limit = {
				MGB = {
					is_subject_of = ROOT
				}
			}
			MGB = {
				2474 = {
					add_siberian_construction = 30
				}
				2475 = {
					add_siberian_construction = 30
				}
				1127 = {
					add_siberian_construction = 30
				}
			}
		}
		else = {
			2474 = {
				add_siberian_construction = 30
			}
			2475 = {
				add_siberian_construction = 30
			}
			1127 = {
				add_siberian_construction = 30
			}
		}
	}

	option = { #Tall meta
		name = ME_Castile_Events.24.b

		ai_chance = {
			factor = 20
		}
		
		highlight = yes
		trigger = {
			MGB = {
				is_subject_of = ROOT
			}
		}

		MGB = {
			add_country_modifier = {
				name = EE_spa_maghreb_development
				duration = -1
			}
		}
	}
}

country_event = { #Masters of the Aegean
	id = ME_Castile_Events.25
	title = ME_Castile_Events.25.t
	desc = ME_Castile_Events.25.d
	picture = HARBOUR_eventPicture

	is_triggered_only = yes

	option = { #Fortifications
		name = ME_Castile_Events.25.a

		ai_chance = {
			factor = 80
		}

		custom_tooltip = EE_SPA_GRANT_PROVINCES_NAVAL_BATTERYS
		hidden_effect = {
			random_owned_province = {
				limit = {
					area = corsica_sardinia_area
					province_id = 126
					province_id = 163
					province_id = 320
					province_id = 2348
					province_id = 4700
					province_id = 3003
					province_id = 164
					province_id = 321
				}
				if = {
					limit = {
						has_building = coastal_defence
					}
					remove_building = coastal_defence
					add_building = naval_battery
				}
				else_if = {
					limit = {
						has_building = naval_battery
					}
					add_base_production = 2
				}
				else = {
					add_building = coastal_defence
				}
			}
			random_owned_province = {
				limit = {
					area = corsica_sardinia_area
					province_id = 126
					province_id = 163
					province_id = 320
					province_id = 2348
					province_id = 4700
					province_id = 3003
					province_id = 164
					province_id = 321
				}
				if = {
					limit = {
						has_building = coastal_defence
					}
					remove_building = coastal_defence
					add_building = naval_battery
				}
				else_if = {
					limit = {
						has_building = naval_battery
					}
					add_base_production = 2
				}
				else = {
					add_building = coastal_defence
				}
			}
			random_owned_province = {
				limit = {
					area = corsica_sardinia_area
					province_id = 126
					province_id = 163
					province_id = 320
					province_id = 2348
					province_id = 4700
					province_id = 3003
					province_id = 164
					province_id = 321
				}
				if = {
					limit = {
						has_building = coastal_defence
					}
					remove_building = coastal_defence
					add_building = naval_battery
				}
				else_if = {
					limit = {
						has_building = naval_battery
					}
					add_base_production = 2
				}
				else = {
					add_building = coastal_defence
				}
			}
			random_owned_province = {
				limit = {
					area = corsica_sardinia_area
					province_id = 126
					province_id = 163
					province_id = 320
					province_id = 2348
					province_id = 4700
					province_id = 3003
					province_id = 164
					province_id = 321
				}
				if = {
					limit = {
						has_building = coastal_defence
					}
					remove_building = coastal_defence
					add_building = naval_battery
				}
				else_if = {
					limit = {
						has_building = naval_battery
					}
					add_base_production = 2
				}
				else = {
					add_building = coastal_defence
				}
			}
			random_owned_province = {
				limit = {
					area = corsica_sardinia_area
					province_id = 126
					province_id = 163
					province_id = 320
					province_id = 2348
					province_id = 4700
					province_id = 3003
					province_id = 164
					province_id = 321
				}
				if = {
					limit = {
						has_building = coastal_defence
					}
					remove_building = coastal_defence
					add_building = naval_battery
				}
				else_if = {
					limit = {
						has_building = naval_battery
					}
					add_base_production = 2
				}
				else = {
					add_building = coastal_defence
				}
			}
		}
	}

	option = { #Shipbuilding
		name = ME_Castile_Events.25.b

		ai_chance = {
			factor = 20
		}

		custom_tooltip = EE_SPA_GRANT_MODIFIER_IN_PROVINCES
		tooltip = {
			add_province_modifier = {
				name = EE_spa_forward_base
				duration = -1
			}
		}
		
		hidden_effect = {
			random_owned_province = {
				limit = {
					area = corsica_sardinia_area
					province_id = 126
					province_id = 163
					province_id = 320
					province_id = 2348
					province_id = 4700
					province_id = 3003
					province_id = 164
					province_id = 321
				}
				add_province_modifier = {
					name = EE_spa_forward_base
					duration = -1
				}
			}
			random_owned_province = {
				limit = {
					area = corsica_sardinia_area
					province_id = 126
					province_id = 163
					province_id = 320
					province_id = 2348
					province_id = 4700
					province_id = 3003
					province_id = 164
					province_id = 321
				}
				add_province_modifier = {
					name = EE_spa_forward_base
					duration = -1
				}
			}
			random_owned_province = {
				limit = {
					area = corsica_sardinia_area
					province_id = 126
					province_id = 163
					province_id = 320
					province_id = 2348
					province_id = 4700
					province_id = 3003
					province_id = 164
					province_id = 321
				}
				add_province_modifier = {
					name = EE_spa_forward_base
					duration = -1
				}
			}
			random_owned_province = {
				limit = {
					area = corsica_sardinia_area
					province_id = 126
					province_id = 163
					province_id = 320
					province_id = 2348
					province_id = 4700
					province_id = 3003
					province_id = 164
					province_id = 321
				}
				add_province_modifier = {
					name = EE_spa_forward_base
					duration = -1
				}
			}
			random_owned_province = {
				limit = {
					area = corsica_sardinia_area
					province_id = 126
					province_id = 163
					province_id = 320
					province_id = 2348
					province_id = 4700
					province_id = 3003
					province_id = 164
					province_id = 321
				}
				add_province_modifier = {
					name = EE_spa_forward_base
					duration = -1
				}
			}
		}
	}
}

country_event = { #A Habsburg Prince
	id = ME_Castile_Events.26
	title = ME_Castile_Events.26.t
	desc = ME_Castile_Events.26.d
	picture = HRE_eventPicture

	is_triggered_only = yes

	option = { #Create the Habsburgs
		name = ME_Castile_Events.26.a

		ai_chance = {
			factor = 100
		}
		
		tooltip = {
			define_heir = {
				name = "Charles"
				dynasty = "von Habsburg"
				age = 0
				adm = 5
				dip = 5
				mil = 4
				claim = 80
				no_consort_with_heir = yes
			}
			set_heir_flag = ee_spa_charles_heir
			custom_tooltip = " "
			custom_tooltip = EE_SPA_CHARLES_EMPIRE
		}
		HAB = { country_event = { id = ME_Castile_Events.27 } } #NOTE: Immplement the stuff on on_monarch_death
	}

	option = { #Shy away from European Politics
		name = ME_Castile_Events.26.b

		ai_chance = {
			factor = 20
		}
		
		add_prestige = 5 #Give something else
	}
}

country_event = { #A Habsburg Prince
	id = ME_Castile_Events.27
	title = ME_Castile_Events.27.t
	desc = ME_Castile_Events.27.d
	picture = HRE_eventPicture

	is_triggered_only = yes
	major = yes

	option = { #Create the Habsburgs
		name = ME_Castile_Events.27.a

		ai_chance = {
			factor = 100
		}
		
		FROM = {
			define_heir = {
				name = "Charles"
				dynasty = "von Habsburg"
				age = 0
				adm = 5
				dip = 5
				mil = 4
				claim = 80
				no_consort_with_heir = yes
			}
			set_heir_flag = ee_spa_charles_heir
			custom_tooltip = " "
			custom_tooltip = EE_SPA_CHARLES_EMPIRE
		}
		define_heir = {
			name = "Charles"
			dynasty = "von Habsburg"
			age = 0
			adm = 5
			dip = 5
			mil = 4
			claim = 80
			no_consort_with_heir = yes
		}
		set_heir_flag = ee_spa_charles_heir
		complete_mission = me_hab_iberia
	}

	option = { #Create the Habsburgs
		name = ME_Castile_Events.27.b

		ai_chance = {
			factor = 0
		}
		
		FROM = {
			add_casus_belli = {
				type = cb_restore_personal_union
				target = HAB
				months = 120
			}
		}
	}
}

country_event = { #Slayer of France
	id = ME_Castile_Events.28
	title = ME_Castile_Events.28.t
	desc = ME_Castile_Events.28.d
	picture = CONQUEST_eventPicture

	is_triggered_only = yes
	major = yes

	option = { #Tolerate them
		name = ME_Castile_Events.28.a

		ai_chance = {
			factor = 100
		}
		custom_tooltip = EE_SPA_DEVVING_FRENCH_PROVINCES_10_CHANCE
		set_country_flag = ee_spa_france_double_dev
		ME_distribute_development = {
			amount = 5
			type = manpower
			limit = " region = france_region "
		}
		ME_distribute_development = {
			amount = 5
			type = tax
			limit = " region = france_region "
		}
		ME_distribute_development = {
			amount = 5
			type = production
			limit = " region = france_region "
		}
	}

	option = { #Create a hegemony
		name = ME_Castile_Events.28.b

		ai_chance = {
			factor = 0
		}
		add_years_of_income = 1
		add_country_modifier = {
			name = EE_spa_western_europe_hegemon
			duration = -1
		}
	}
}

country_event = { #Slayer of France
	id = ME_Castile_Events.29
	title = ME_Castile_Events.29.t
	desc = ME_Castile_Events.29.d
	picture = BORDER_TENSION_eventPicture

	is_triggered_only = yes
	major = yes

	option = { #Tolerate them
		name = ME_Castile_Events.29.a

		ai_chance = {
			factor = 100
		}
		
	}
}

country_event = {
	id = ME_Castile_Events.30
	title = ME_Castile_Events.30.t
	desc = ME_Castile_Events.30.d
	picture = BORDER_TENSION_eventPicture

	fire_only_once = yes
	
	trigger = {
		tag = GRA
	}

	mean_time_to_happen = {
		days = 1
	}

	option = {
		name = ME_Castile_Events.30.a

		custom_tooltip = EE_granada_holding_out
	}
}

country_event = {
	id = ME_Castile_Events.31
	title = "flavor_spa.EVTNAME1"
	desc = "flavor_spa.EVTDESC1"
	picture = SHIP_SAILING_eventPicture

	is_triggered_only = yes

	option = {		# Reject his proposal
		name = "flavor_spa.EVTOPTA1"
		ai_chance = { factor = 10 }
		set_country_flag = turned_down_columbus
		random_known_country = {
			limit = {
				NOT = { has_country_flag = turned_down_columbus }
				religion = catholic
				has_idea = quest_for_the_new_world
			}
			country_event = { id = flavor_spa.1 }
		}
	}
	option = {		# Hire Columbus
		name = "flavor_spa.EVTOPTB1"
		ai_chance = { factor = 90 }
		add_years_of_income = -0.25
		set_global_flag = columbus_happened
		define_explorer = {
			name = "NAME_CRISTOBAL_COLON"
			fire = 2
			shock = 2
			manuever = 6
			siege = 0
		}
	}
}

country_event = {
	id = ME_Castile_Events.32
	title = ME_Castile_Events.32.t
	desc = ME_Castile_Events.32.d
	picture = COLONIZATION_eventPicture

	is_triggered_only = yes

	option = {
		name = ME_Castile_Events.32.a

		add_inflation = 5
		EE_spa_upgrade_seizing_american_gold = yes
		custom_tooltip = " "
		custom_tooltip = EE_SPA_UPGRADE_GOLD_PROVINCES
		hidden_effect = {
			peru_region = {
				limit = {
					country_or_non_sovereign_subject_holds = ROOT
					trade_goods = gold
				}
				add_base_production = 2
			}
		}
	}

	option = {
		name = ME_Castile_Events.32.b

		808 = {
			add_base_production = 2
			add_permanent_province_modifier = { #Yes, the modifier *is* meant to be global, aka it's where the Puppet Inca Emperor is
				name = EE_spa_puppet_inca
				duration = -1
			}
		}

	}
}

country_event = {
	id = ME_Castile_Events.33
	title = ME_Castile_Events.33.t
	desc = ME_Castile_Events.33.d
	picture = FAMINE_eventPicture

	is_triggered_only = yes

	option = {
		name = ME_Castile_Events.33.a

		add_inflation = 3
		EE_spa_upgrade_seizing_american_gold = yes
	}

	option = {
		name = ME_Castile_Events.33.b

		add_years_of_income = 0.5
		every_subject_country = {
			limit = {
				capital_scope = {
					colonial_region = colonial_mexico
				}
			}
			add_accepted_culture_or_dip_power = { culture = aztek } #Will allow them to use the monument
		}
	}
}

country_event = {
	id = ME_Castile_Events.34
	title = ME_Castile_Events.34.t
	desc = ME_Castile_Events.34.d
	picture = CITY_DEVELOPMENT_eventPicture

	is_triggered_only = yes

	option = {
		name = ME_Castile_Events.34.a

		every_subject_country = {
			add_liberty_desire = -25
		}
		add_government_power = {
			mechanic_type = spanish_economic_decline_mechanic
			power_type = economic_decline
			value = -5
		}
	}

	option = {
		name = ME_Castile_Events.34.b

		add_inflation = 5
		custom_tooltip = " "
		custom_tooltip = EE_SPA_GIVE_EVERY_MEXICAN_GOLD_PROVINCE_BUFF
		hidden_effect = {
			colonial_mexico = {
				limit = {
					trade_goods = gold
				}
				add_province_modifier = {
					name = EE_spa_mexican_gold
					duration = -1
				}
			}
		}
	}
}

country_event = {
	id = ME_Castile_Events.35
	title = ME_Castile_Events.35.t
	desc = ME_Castile_Events.35.d
	picture = ADVISOR_eventPicture

	fire_only_once = yes

	trigger = {
		OR = {
			tag = CAS
			tag = SPA
		}
		is_year = 1550
	}

	mean_time_to_happen = {
		months = 120
	}

	option = {
		name = ME_Castile_Events.35.a

		define_advisor = {
			type = artist
			name = "Domenikos Theotokopoulos"
			skill = 3
			culture = greek
			religion = orthodox
			cost_multiplier = 0.2
		}
	}
}

country_event = {
	id = ME_Castile_Events.36
	title = ME_Castile_Events.36.t
	desc = ME_Castile_Events.36.d
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes
	major = yes

	option = {
		name = ME_Castile_Events.36.a

		custom_tooltip = EE_SPA_ALL_THE_TRADE_GOODS_WILL_GET_PRICE_INCREASE
	}
}

country_event = {
	id = ME_Castile_Events.37
	title = ME_Castile_Events.37.t
	desc = ME_Castile_Events.37.d
	picture = COLONIZATION_eventPicture

	is_triggered_only = yes

	option = {
		name = ME_Castile_Events.37.a
		add_country_modifier = {
			name = ee_spa_trade_companies
			duration = 7300
		}
		custom_tooltip = " "
		#buff provinces
		random_province = {
			limit = {
				OR = {
					area = visayas_area
					area = southern_luzon_area
					area = luzon_area
					area = mindanao_area
					area = west_mindanao_area
				}
				country_or_non_sovereign_subject_holds = ROOT
			}
			add_or_upgrade_production_building = yes
			add_base_production = 3
		}
		random_province = {
			limit = {
				OR = {
					area = visayas_area
					area = southern_luzon_area
					area = luzon_area
					area = mindanao_area
					area = west_mindanao_area
				}
				country_or_non_sovereign_subject_holds = ROOT
			}
			add_or_upgrade_production_building = yes
			add_base_production = 3
		}
		random_province = {
			limit = {
				OR = {
					area = visayas_area
					area = southern_luzon_area
					area = luzon_area
					area = mindanao_area
					area = west_mindanao_area
				}
				country_or_non_sovereign_subject_holds = ROOT
			}
			add_or_upgrade_production_building = yes
			add_base_production = 3
		}
	}

	option = {
		name = ME_Castile_Events.37.b

		custom_tooltip = EE_SPA_RELEASE_PHILIPINES
		hidden_effect = {
			every_province = {
				limit = {
					OR = {
						area = visayas_area
						area = southern_luzon_area
						area = luzon_area
						area = mindanao_area
						area = west_mindanao_area
					}
					country_or_non_sovereign_subject_holds = ROOT
				}
				cede_province = TDO
				add_core = TDO
			}
			vassalize = TDO
			TDO = {
				change_religion = ROOT
				ME_override_country_name = { name = philipines }
			}
		}
		custom_tooltip = " "
		4352 = {
			add_trade_modifier = {
				who = ROOT
				duration = -1
				power = 30
				key = STRONG_MERCHANTS
			}
		}
		TDO = {
			add_country_modifier = {
				name = ee_spa_philipines_vassal
				duration = -1
			}
		}
	}
}

country_event = { #Marine buffs
	id = ME_Castile_Events.38
	title = ME_Castile_Events.38.t
	desc = ME_Castile_Events.38.d
	picture = BATTLE_eventPicture

	is_triggered_only = yes

	option = {
		name = ME_Castile_Events.38.a

		custom_tooltip = EE_SPA_UPGRADE_MARINE_QUALITY
		hidden_effect = {
			remove_country_modifier = ee_spa_infanteria_de_marina
			add_country_modifier = {
				name = ee_spa_infanteria_de_marina_2
				duration = -1
			}
		}
	}

	option = {
		name = ME_Castile_Events.38.b

		custom_tooltip = EE_SPA_UPGRADE_MARINE_QUANTITY
		hidden_effect = {
			remove_country_modifier = ee_spa_marine_corps
			add_country_modifier = {
				name = ee_spa_marine_corps_2
				duration = -1
			}
		}
	}
}

country_event = { #MThe Impostor is Found
	id = ME_Castile_Events.39
	title = ME_Castile_Events.39.t
	desc = ME_Castile_Events.39.d
	picture = ASSASSINATION_eventPicture

	is_triggered_only = yes

	option = {
		name = ME_Castile_Events.39.a

		define_advisor = {
			type = ME_impostor
			skill = 3
			cost_multiplier = 0.5
			culture = berber
			religion = sunni
		}
	}

	option = {
		name = ME_Castile_Events.39.b

		add_prestige_or_monarch_power = { amount = 10 }
	}
}

country_event = { #MStart of the Inquisition
	id = ME_Castile_Events.40
	title = ME_Castile_Events.40.t
	desc = ME_Castile_Events.40.d
	picture = RELIGIOUS_TURMOIL_eventPicture

	is_triggered_only = yes
	
	option = {
		name = ME_Castile_Events.40.a

		custom_tooltip = EE_SPA_EXPLAIN_INQUISITION
		custom_tooltip = " "
		custom_tooltip = EE_SPA_IF_TOLERATED
		custom_tooltip = " "
		tooltip = {
			reverse_add_opinion = {
				who = PAP
				modifier = spain_tolerated_heretics
			}
			add_country_modifier = {
				name = ee_spa_tolerance_outcome
				duration = 7300
			}
			add_estate_loyalty = {
				estate = estate_church
				loyalty = -15
			}
		}
		custom_tooltip = " "
		custom_tooltip = EE_SPA_IF_CONVERTED
		custom_tooltip = " "
		tooltip = {
			add_reform_desire = 0.05
			add_estate_loyalty = {
				estate = estate_church
				loyalty = 20
			}
			add_country_modifier = {
				name = ee_spa_conversion_outcome
				duration = 7300
			}
		}
		hidden_effect = {
			country_event = {
				id = ME_Castile_Events.41
				days = 70
			}
			set_variable = {
				which = EE_spa_inquisition_conversion
				value = 0
			}
			set_variable = {
				which = EE_spa_inquisition_tolerance
				value = 0
			}
		}
	}
}

country_event = { #The Muslims and Moriscos
	id = ME_Castile_Events.41
	title = ME_Castile_Events.41.t
	desc = ME_Castile_Events.41.d
	picture = RAMADAN_eventPicture

	is_triggered_only = yes

	option = { #Tolerate
		name = ME_Castile_Events.41.a

		custom_tooltip = EE_SPA_CHECK_TOLERANCE_VS_CONVERSION
		
		EE_change_variable = {
			which = EE_spa_inquisition_tolerance
			add = 5
		}
		add_papal_influence = 5
		custom_tooltip = EE_SPA_DISTRIBUTE_DEV_IN_ANDALUSIA
		hidden_effect = {
			ME_distribute_development = {
				type = tax
				amount = 5
				limit = "
					OR = {
						area = lower_andalucia_area
						area = upper_andalucia_area
					}
				"
			}
		}
	}

	option = {
		name = ME_Castile_Events.41.b

		custom_tooltip = EE_SPA_CHECK_TOLERANCE_VS_CONVERSION
		
		EE_change_variable = {
			which = EE_spa_inquisition_conversion
			add = 5
		}
		add_years_of_income = 0.5
		add_estate_loyalty = {
			estate = estate_church
			loyalty = 10
		}
	}

	after = {
		country_event = {
			id = ME_Castile_Events.42
			days = 70
		}
	}
}

country_event = { #The Jews
	id = ME_Castile_Events.42
	title = ME_Castile_Events.42.t
	desc = ME_Castile_Events.42.d
	picture = RELIGIOUS_CONVERSIONS_eventPicture

	is_triggered_only = yes

	option = { #Tolerate
		name = ME_Castile_Events.42.a

		custom_tooltip = EE_SPA_CHECK_TOLERANCE_VS_CONVERSION
		
		EE_change_variable = {
			which = EE_spa_inquisition_tolerance
			add = 5
		}
		
		add_country_modifier = {
			name = ee_spa_tolerance_of_jews
			duration = 3650
		}
	}

	option = {
		name = ME_Castile_Events.42.b

		custom_tooltip = EE_SPA_CHECK_TOLERANCE_VS_CONVERSION
		
		EE_change_variable = {
			which = EE_spa_inquisition_conversion
			add = 5
		}
		add_years_of_income = 1
		add_country_modifier = {
			name = ee_spa_expelled_the_jews
			duration = 3650
		}
	}

	after = {
		country_event = {
			id = ME_Castile_Events.43
			days = 70
		}
	}
}

country_event = { #Witchhunting
	id = ME_Castile_Events.43
	title = ME_Castile_Events.43.t
	desc = ME_Castile_Events.43.d
	picture = RELIGION_eventPicture

	is_triggered_only = yes

	option = { #Tolerate
		name = ME_Castile_Events.43.a

		custom_tooltip = EE_SPA_CHECK_TOLERANCE_VS_CONVERSION
		
		EE_change_variable = {
			which = EE_spa_inquisition_tolerance
			add = 5
		}
		
		add_country_modifier = {
			name = ee_spa_banned_witchcrafts
			duration = 7300
		}
		add_estate_loyalty = {
			estate = estate_church
			loyalty = -10
		}
	}

	option = {
		name = ME_Castile_Events.43.b

		custom_tooltip = EE_SPA_CHECK_TOLERANCE_VS_CONVERSION
		
		EE_change_variable = {
			which = EE_spa_inquisition_conversion
			add = 5
		}

		add_country_modifier = {
			name = ee_spa_state_sponsored_witchcrafts
			duration = 3650
		}
	}

	after = {
		country_event = {
			id = ME_Castile_Events.44
			days = 70
		}
	}
}

country_event = { #Inquisition outcome
	id = ME_Castile_Events.44
	title = ME_Castile_Events.44.t
	desc = ME_Castile_Events.44.d
	picture = RELIGIOUS_WARS_eventPicture

	is_triggered_only = yes
	
	option = {
		name = ME_Castile_Events.44.a

		custom_tooltip = EE_SPA_END_INQUISITION
		custom_tooltip = " "
		if = {
			limit = {
				check_variable = {
					which = EE_spa_inquisition_tolerance
					which = EE_spa_inquisition_conversion
				}
			}
			reverse_add_opinion = {
				who = PAP
				modifier = spain_tolerated_heretics
			}
			add_country_modifier = {
				name = ee_spa_tolerance_outcome
				duration = 7300
			}
			add_estate_loyalty = {
				estate = estate_church
				loyalty = -15
			}
		}
		else = {
			add_reform_desire = 0.05
			add_estate_loyalty = {
				estate = estate_church
				loyalty = 20
			}
			add_country_modifier = {
				name = ee_spa_conversion_outcome
				duration = 7300
			}
		}
	}
}

country_event = { #Mestra Monopolies
	id = ME_Castile_Events.45
	title = ME_Castile_Events.45.t
	desc = ME_Castile_Events.45.d
	picture = TRADE_GOODS_eventPicture

	is_triggered_only = yes
	
	option = {
		name = ME_Castile_Events.45.a

		add_estate_influence_modifier = {
			estate = estate_nobles
			influence = 15
			duration = 7300
		}
		custom_tooltip = " "
		custom_tooltip = EE_SPA_DISTRIBUTE_DEV_IN_LIVESTOCK
		hidden_effect = {
			ME_distribute_development = {
				type = production
				amount = 25
				limit = "
					region = iberia_region
					OR = {
						trade_goods = livestock
						trade_goods = wool
					}
				"
			}
		}
	}

	option = {
		name = ME_Castile_Events.45.b
		
		add_years_of_owned_provinces_production_income = {
			years = 4
			trigger = {
				OR = {
					trade_goods = wool
					trade_goods = livestock
				}
			}
			custom_tooltip = MESTRA_MONOPOLY_INCOME
		}
	}
}

country_event = { #Laws of Burgos
	id = ME_Castile_Events.46
	title = ME_Castile_Events.46.t
	desc = ME_Castile_Events.46.d
	picture = COURT_eventPicture

	is_triggered_only = yes
	
	option = {
		name = ME_Castile_Events.46.a

		custom_tooltip = EE_SPA_GRANT_RELIGIOUS_BUFFS_TO_CNS #NOT IMPLEMENTED TREE YET
		hidden_effect = {
			every_subject_country = {
				limit = {
					OR = {
						is_subject_of_type = colony
						is_subject_of_type = crown_colony
						is_subject_of_type = private_enterprise
						is_subject_of_type = self_governing_colony
					}
				}
				add_country_modifier = {
					name = ee_spa_conversion_of_natives
					duration = -1
				}
			}
			set_country_flag = ee_spa_burgos_conversion_option
		}
		
	}

	option = {
		name = ME_Castile_Events.46.b
		
		custom_tooltip = EE_SPA_GRANT_TOLERANCE_BUFFS_TO_CNS #NOT IMPLEMENTED TREE YET
		custom_tooltip = " "
		add_country_modifier = {
			name = ee_spa_toleration_option
			duration = -1
		}
		hidden_effect = {
			every_subject_country = {
				limit = {
					OR = {
						is_subject_of_type = colony
						is_subject_of_type = crown_colony
						is_subject_of_type = private_enterprise
						is_subject_of_type = self_governing_colony
					}
				}
				add_country_modifier = {
					name = ee_spa_toleration_of_natives
					duration = -1
				}
			}
		}
	}
}

country_event = { #Imperial Spain
	id = ME_Castile_Events.47
	title = ME_Castile_Events.47.t
	desc = ME_Castile_Events.47.d
	picture = HRE_eventPicture

	is_triggered_only = yes
	
	option = {
		name = ME_Castile_Events.47.a

		custom_tooltip = EE_SPA_MERGE_ALL_COLONIES
		tooltip = {
			add_country_modifier = {
				name = "ee_spa_the_colony"
				duration = -1
			}
		}
			hidden_effect = {
				random_subject_country = {
					limit = {
						OR = {
							is_subject_of_type = colony
							is_subject_of_type = crown_colony
							is_subject_of_type = private_enterprise
							is_subject_of_type = self_governing_colony
						}
						if = {
							limit = {
								was_player = yes
							}
							was_player = yes
						}
					}
					save_event_target_as = ee_spa_big_colony
					set_country_flag = ee_spa_big_colony_flag
					add_liberty_desire = -100
					add_country_modifier = {
						name = "ee_spa_the_colony"
						duration = -1
					}
				}
				every_subject_country = {
					limit = {
						OR = {
							is_subject_of_type = colony
							is_subject_of_type = crown_colony
							is_subject_of_type = private_enterprise
							is_subject_of_type = self_governing_colony
						}
						NOT = { has_country_flag = ee_spa_big_colony_flag } 
					}
					event_target:ee_spa_big_colony = { inherit = PREV } 
				}
			}
		
	}

	option = {
		name = ME_Castile_Events.47.b
		
		add_country_modifier = {
			name = ee_spa_american_hegemony
			duration = -1
		}
	}
}

country_event = { #Alvaro de Luna
	id = ME_Castile_Events.48
	title = ME_Castile_Events.48.t
	desc = ME_Castile_Events.48.d
	picture = ADVISOR_eventPicture

	fire_only_once = yes

	trigger = {
		tag = CAS
		has_leader = "Alvaro de Luna"
	}

	mean_time_to_happen = {
		months = 25
	}
	
	option = { #Execute him
		name = ME_Castile_Events.48.a

		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = 35
		}
		kill_leader = {
			type = "Alvaro de Luna"
		}
	}

	option = { #Keep him
		name = ME_Castile_Events.48.b
		
		custom_tooltip = EE_SPA_EASIER_KNIGHTS_OF_SANTIAGO
		set_country_flag = ee_kept_luna_alive
		custom_tooltip = " "
		add_estate_influence_modifier = {
			estate = estate_nobles
			influence = -5
			duration = 7300
		}
	}
}

country_event = { #Selling Madagascar
	id = ME_Castile_Events.49
	title = ME_Castile_Events.49.t
	desc = ME_Castile_Events.49.d
	picture = MERCHANTS_TALKING_eventPicture

	is_triggered_only = yes
	major = yes
	
	option = { #Sell it to them
		name = ME_Castile_Events.49.a
		ai_chance = { factor = 100 }

		custom_tooltip = EE_SPA_GAIN_YEARS_OF_INCOME
		sakalava_area = {
			cede_province = FROM
			add_core = FROM
		}
		southern_madagascar = {
			cede_province = FROM
			add_core = FROM
		}
		madagascar_highlands_area = {
			cede_province = FROM
			add_core = FROM
		}
		betsimasaraka_area = {
			cede_province = FROM
			add_core = FROM
		}
		hidden_effect = {
			while = {
				limit = {
					FROM = {
						check_variable = {
							which = spanish_years_of_income
							value = 1
						}
					}
				}
				FROM = {
					add_treasury = -1
				}
				ROOT = {
					add_treasury = 1
				}
				FROM = {
					change_variable = {
						which = spanish_years_of_income
						value = -1
					}
				}
			}
		}
	}

	option = { #We refuse
		name = ME_Castile_Events.49.b
		ai_chance = { factor = 0 }
		
		FROM = {
			ME_give_claims = { area = sakalava_area }
			ME_give_claims = { area = southern_madagascar }
			ME_give_claims = { area = madagascar_highlands_area }
			ME_give_claims = { area = betsimasaraka_area }
		}
	}
}

country_event = {
	id = ME_Castile_Events.50
	title = ME_Castile_Events.50.t
	desc = ME_Castile_Events.50.d
	picture = FARMING_eventPicture

	is_triggered_only = yes
	major = yes
	
	option = { #Sell it to them
		name = ME_Castile_Events.50.a
		ai_chance = { factor = 100 }

		remove_estate_privilege = EE_estate_nobles_encomienda_system
		set_estate_privilege = EE_estate_settlers_encomienda_system
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = 15
		}
	}

	option = { #We refuse
		name = ME_Castile_Events.50.b
		ai_chance = { factor = 0 }
		
		remove_estate_privilege = EE_estate_nobles_encomienda_system
		add_estate_loyalty = {
			estate = estate_settlers
			loyalty = 15
		}
	}
}

country_event = { #Economic Downfall
	id = ME_Castile_Events.51
	title = ME_Castile_Events.51.t
	desc = ME_Castile_Events.51.d
	picture = OVEREXTENSION_eventPicture

	trigger = {
		OR = {
			tag = CAS
			tag = SPA
		}
		colony = 1
	}

	mean_time_to_happen = {
		months = 12
	}
	major = yes
	fire_only_once = yes
	
	option = {
		name = ME_Castile_Events.51.a
		ai_chance = { factor = 100 }
		
		custom_tooltip = EE_SPA_UNLOCK_ECONOMIC_DOWNFALL_MECHANIC
		set_country_flag = ee_spa_unlocked_economic_downfall_mechanic
		regenerate_government_mechanics = yes
		#set_country_flag = ee_spa_economic_downfall
	}
}

country_event = { #Universal Monarchy
	id = ME_Castile_Events.52
	title = ME_Castile_Events.52.t
	desc = ME_Castile_Events.52.d
	picture = OVEREXTENSION_eventPicture

	trigger = {
		OR = {
			tag = CAS
			tag = SPA
		}
		senior_union_with = HAB
		is_emperor = yes
		has_country_flag = ee_spa_peaceful_pu
	}

	mean_time_to_happen = {
		months = 12
	}
	major = yes
	fire_only_once = yes
	
	option = {
		name = ME_Castile_Events.52.a
		ai_chance = { factor = 0 }

		add_country_modifier = {
			name = ee_spa_universal_empire
			duration = -1
			desc = ee_spa_until_pu_is_broken
		}
	}

	option = {
		name = ME_Castile_Events.52.b
		ai_chance = { factor = 100 }

		break_union = HAB
		HAB = {
			define_ruler = {
				name = "Ferdinand"
				dynasty = ROOT
				adm = 4
				dip = 4
				mil = 4
				age = 20
				claim = 75
			}
		}
		remove_casus_belli = {
			target = HAB
			type = cb_restore_personal_union
		}
		HAB = {
			set_emperor = yes
		}
		custom_tooltip = EE_SPA_CEDE_FRANCE_AND_LOW_COUNTRIES

		hidden_effect = {
			low_countries_region = {
				limit = {
					owned_by = HAB
				}
				cede_province = ROOT
				add_core = ROOT
				add_local_autonomy = 25
			}
			france_region = {
				limit = {
					owned_by = HAB
				}
				cede_province = ROOT
				add_core = ROOT
				add_local_autonomy = 25
			}
		}
	}

	option = {
		name = ME_Castile_Events.52.c
		ai_chance = { factor = 100 }

		break_union = HAB
		HAB = {
			define_ruler = {
				name = "Ferdinand"
				dynasty = ROOT
				adm = 4
				dip = 4
				mil = 4
				age = 20
				claim = 75
			}
		}
		remove_casus_belli = {
			target = HAB
			type = cb_restore_personal_union
		}
		hidden_effect = {
			every_subject_country = {
				limit = {
					is_subject_of_type = ME_Austrian_personal_union
				}
				free_vassal = PREV
				HAB = {
					create_subject = {
						subject_type = ME_Austrian_personal_union
						subject = PREV
					}
				}
			}
			if = {
				limit = {
					BOH = {
						junior_union_with = ROOT
					}
				}
				free_vassal = BOH
				HAB = {
					create_subject = {
						subject_type = ME_Austrian_personal_union
						subject = BOH
					}
				}
			}
			if = {
				limit = {
					HUN = {
						junior_union_with = ROOT
					}
				}
				free_vassal = HUN
				HAB = {
					create_subject = {
						subject_type = ME_Austrian_personal_union
						subject = HUN
					}
				}
			}
		}
	}
}

country_event = { #El Gran Capitan
	id = ME_Castile_Events.53
	title = ME_Castile_Events.53.t
	desc = ME_Castile_Events.53.d
	picture = LAND_MILITARY_eventPicture

	trigger = {
		OR = {
			tag = CAS
			tag = SPA
		}
		is_year = 1510
		mission_completed = EE_spa_adopt_pike_and_shot
	}

	mean_time_to_happen = {
		months = 120
	}
	
	fire_only_once = yes
	
	option = {
		name = ME_Castile_Events.53.a
		ai_chance = { factor = 100 }

		define_general = {
			name = "Gonzalo Fernandez de Cordoba"
			shock = 4
			fire = 2
			manuever = 4
			siege = 1
			trait = el_gran_capitan
		}
		custom_tooltip = " "
		custom_tooltip = EE_DOUBLE_TERCIO_GAIN_WITH_LEADER
	}
}

country_event = { #Creation of the Universal Empire
	id = ME_Castile_Events.54
	title = ME_Castile_Events.54.t
	desc = ME_Castile_Events.54.d
	picture = GOOD_WITH_MONARCH_eventPicture

	is_triggered_only = yes
	major = yes
	
	fire_only_once = yes
	
	option = {
		name = ME_Castile_Events.54.a
		ai_chance = { factor = 100 }

		set_country_flag = ee_spa_peaceful_pu
		if = {
			limit = {
				tag = HAB
			}
			if = {
				limit = {
					exists = CAS
				}
				create_union = CAS
			}
			else = {
				create_union = SPA
			}
		}
		else = {
			if = {
				limit = {
					HAB = {
						is_emperor = yes
					}
				}
				set_emperor = yes
			}
			create_union = HAB
			hidden_effect = {
				HAB = {
					every_subject_country = {
						limit = {
							is_subject_of_type = ME_Austrian_personal_union
						}
						free_vassal = PREV
						ROOT = {
							create_subject = {
								subject_type = ME_Austrian_personal_union
								subject = PREV
							}
						}
					}
				}
			}
		}
	}
}

country_event = { #Granada Under Attack
	id = ME_Castile_Events.55
	title = ME_Castile_Events.55.t
	desc = ME_Castile_Events.55.d
	picture = BATTLE_eventPicture

	is_triggered_only = yes
	
	option = {
		name = ME_Castile_Events.55.a
		ai_chance = { 
			factor = 20
			modifier = {
				factor = 0
				NOT = { 
					has_opinion = {
						who = GRA
						value = -50
					}
				}
			}
			modifier = {
				factor = 0
				OR = {
					has_opinion = {
						who = CAS
						value = 75
					}
					ai_attitude = {
						who = CAS
						attitude = attitude_allied
					}
					ai_attitude = {
						who = CAS
						attitude = attitude_threatened
					}
				}
			}
			modifier = {
				factor = 2
				has_opinion = {
					who = GRA
					value = 75
				}
			}
			modifier = {
				factor = 2
				OR = {
					NOT = { 
						has_opinion = {
							who = CAS
							value = -50
						}
					}
					ai_attitude = {
						who = CAS
						attitude = attitude_rivalry
					}
					ai_attitude = {
						who = CAS
						attitude = attitude_hostile
					}
				}
			}
		}

		join_all_defensive_wars_of = GRA
	}

	option = {
		name = ME_Castile_Events.55.b
		ai_chance = { factor = 80 }

		add_prestige_or_monarch_power = { amount = 10 }
		
	}
}

country_event = { #Hunting Accident Path
	id = ME_Castile_Events.56
	title = ME_Castile_Events.56.t
	desc = {
		trigger = {
			has_country_flag = ee_spa_assassination_success
		}
		desc = ME_Castile_Events.56.d.success
	}
	desc = {
		trigger = {
			NOT = { has_country_flag = ee_spa_assassination_success }
		}
		desc = ME_Castile_Events.56.d.fail
	}
	picture = DEATH_OF_HEIR_eventPicture

	is_triggered_only = yes
	
	option = {
		name = ME_Castile_Events.56.a
		ai_chance = { factor = 100 }

		trigger = {
			has_country_flag = ee_spa_assassination_success
		}

		kill_heir = {
			allow_new_heir = no
		}
	}

	option = {
		name = ME_Castile_Events.56.b
		ai_chance = { factor = 100 }

		trigger = {
			NOT = { has_country_flag = ee_spa_assassination_success }
		}

		add_stability = -1
		add_legitimacy = -30
	}
}

country_event = { #Border Incident Path
	id = ME_Castile_Events.57
	title = ME_Castile_Events.57.t
	desc = {
		trigger = {
			has_country_flag = ee_spa_assassination_success
		}
		desc = ME_Castile_Events.57.d.success
	}
	desc = {
		trigger = {
			NOT = { has_country_flag = ee_spa_assassination_success }
		}
		desc = ME_Castile_Events.57.d.fail
	}
	picture = BORDER_TENSION_eventPicture

	immediate = {
		random_neighbor_country = {
			save_event_target_as = neighbour_country
		}
	}

	is_triggered_only = yes
	
	option = {
		name = ME_Castile_Events.57.a
		ai_chance = { factor = 100 }

		trigger = {
			has_country_flag = ee_spa_assassination_success
		}

		kill_heir = {
			allow_new_heir = no
		}
		event_target:neighbour_country = {
			country_event = {
				id = ME_Castile_Events.58
			}
		}
	}

	option = {
		name = ME_Castile_Events.5b.b
		ai_chance = { factor = 100 }

		trigger = {
			NOT = { has_country_flag = ee_spa_assassination_success }
		}

		add_stability = -1
		event_target:neighbour_country = {
			country_event = {
				id = ME_Castile_Events.58
			}
		}
	}
}

country_event = { #Border Incident Path
	id = ME_Castile_Events.58
	title = ME_Castile_Events.58.t
	desc = {
		trigger = {
			FROM = { has_country_flag = ee_spa_assassination_success }
		}
		desc = ME_Castile_Events.58.d.success
	}
	desc = {
		trigger = {
			FROM = { NOT = { has_country_flag = ee_spa_assassination_success } }
		}
		desc = ME_Castile_Events.58.d.fail
	}
	picture = BORDER_TENSION_eventPicture

	is_triggered_only = yes
	
	option = {
		name = ME_Castile_Events.58.a

		if = {
			limit = {
				FROM = {
					has_country_flag = ee_spa_assassination_success
				}
			}
			add_opinion = {
				who = FROM
				modifier = spain_blamed_assassination_on_us
			}
		}
		else = {
			add_opinion = {
				who = FROM
				modifier = spain_faked_assassination
			}
		}
	}

	option = {
		name = ME_Castile_Events.58.b

		trigger = {
			FROM = {
				has_country_flag = ee_spa_assassination_success
			}
		}

		add_casus_belli = {
			type = cb_humiliate
			target = FROM
		}
	}
}

country_event = { #Blaming nobles path
	id = ME_Castile_Events.59
	title = ME_Castile_Events.59.t
	desc = {
		trigger = {
			has_country_flag = ee_spa_assassination_success
		}
		desc = ME_Castile_Events.59.d.success
	}
	desc = {
		trigger = {
			NOT = { has_country_flag = ee_spa_assassination_success }
		}
		desc = ME_Castile_Events.59.d.fail
	}
	picture = ASSASSINATION_eventPicture

	is_triggered_only = yes

	immediate = {
		random_owned_province = {
			limit = {
				NOT = {
					is_capital = yes
				}
			}
			save_event_target_as = target_province
		}
	}
	
	option = {
		name = ME_Castile_Events.59.a

		trigger = {
			has_country_flag = ee_spa_assassination_success
		}

		kill_heir = {
			allow_new_heir = no
		}
		add_estate_influence_modifier = {
			influence = -10
			estate = estate_nobles
			duration = 7300
		}
	}

	option = {
		name = ME_Castile_Events.59.b

		trigger = {
			NOT = { has_country_flag = ee_spa_assassination_success }
		}

		add_stability = -1
		add_estate_loyalty = {
			estate = estate_nobles
			loyalty = -30
		}
	}
}

country_event = { #Hernan Cortez
	id = ME_Castile_Events.60
	title = ME_Castile_Events.60.t
	desc = ME_Castile_Events.60.d
	picture = CONQUEST_eventPicture

	trigger = {
		OR = {
			tag = CAS
			tag = SPA
		}
		colony = 1
		is_year = 1500
	}
	fire_only_once = yes

	mean_time_to_happen = {
		months = 100
	}
	
	option = {
		name = ME_Castile_Events.60.a

		define_conquistador = {
			name = "Hernan Cortez"
			shock = 4
			fire = 4
			manuever = 4
			siege = 2
			trait = legendary_conquistador
		}
	}

	option = {
		name = ME_Castile_Events.60.b

		set_country_flag = dismissed_cortez #:)
	}
}

country_event = { #Francisco Pizzaro
	id = ME_Castile_Events.61
	title = ME_Castile_Events.61.t
	desc = ME_Castile_Events.61.d
	picture = CONQUEST_eventPicture

	trigger = {
		OR = {
			tag = CAS
			tag = SPA
		}
		colony = 1
		is_year = 1500
	}
	fire_only_once = yes

	mean_time_to_happen = {
		months = 200
	}
	
	option = {
		name = ME_Castile_Events.61.a

		define_conquistador = {
			name = "Francisco Pizzaro"
			shock = 5
			fire = 3
			manuever = 4
			siege = 3
			trait = legendary_conquistador
		}
	}

	option = {
		name = ME_Castile_Events.61.b
	}
}

country_event = { #Ferdinand Magellan, the poster boy!
	id = ME_Castile_Events.62
	title = ME_Castile_Events.62.t
	desc = ME_Castile_Events.62.d
	picture = SHIP_eventPicture

	trigger = {
		OR = {
			tag = CAS
			tag = SPA
		}
		colony = 1
		is_year = 1500
	}
	fire_only_once = yes
	
	option = {
		name = ME_Castile_Events.62.a

		define_explorer = {
			name = "Ferdinand Magellan"
			shock = 4
			fire = 4
			manuever = 6
			siege = 0
			trait = grand_voyager
		}
	}

	option = {
		name = ME_Castile_Events.62.b
	}
}

country_event = { #Tercio Decline
	id = ME_Castile_Events.63
	title = ME_Castile_Events.63.t
	desc = ME_Castile_Events.63.d
	picture = SHIP_eventPicture

	trigger = {
		NOT = {
			has_country_flag = ee_spa_reformed_our_army
		}
		mission_completed = EE_spa_tercios
		current_age = age_of_absolutism
	}
	fire_only_once = yes

	mean_time_to_happen = {
		months = 60
	}
	
	option = {
		name = ME_Castile_Events.63.a

		add_country_modifier = {
			name = ee_spa_decline_of_the_tercios
			duration = -1
		}
		set_country_flag = decline_of_the_tercios
	}
}

country_event = { #Increase in Firepower
	id = ME_Castile_Events.64
	title = ME_Castile_Events.64.t
	desc = ME_Castile_Events.64.d
	picture = SHIP_eventPicture

	trigger = {
		NOT = {
			has_country_flag = ee_spa_reformed_our_army
		}
		mission_completed = EE_spa_tercios
		had_country_flag = {
			flag = decline_of_the_tercios
			days = 5475
		}
	}
	fire_only_once = yes

	mean_time_to_happen = {
		months = 60
	}
	
	option = {
		name = ME_Castile_Events.64.a

		remove_country_modifier = ee_spa_decline_of_the_tercios
		add_country_modifier = {
			name = ee_spa_increase_of_firepower
			duration = -1
		}

		clr_country_flag = decline_of_the_tercios
		set_country_flag = increase_in_firepower
	}
}

country_event = { #Domination of Line Infantry
	id = ME_Castile_Events.65
	title = ME_Castile_Events.65.t
	desc = ME_Castile_Events.65.d
	picture = SHIP_eventPicture

	trigger = {
		NOT = {
			has_country_flag = ee_spa_reformed_our_army
		}
		mission_completed = EE_spa_tercios
		had_country_flag = {
			flag = increase_in_firepower
			days = 5475
		}
	}
	fire_only_once = yes

	mean_time_to_happen = {
		months = 60
	}
	
	option = {
		name = ME_Castile_Events.65.a

		clr_country_flag = increase_in_firepower
		remove_country_modifier = ee_spa_increase_of_firepower
		add_country_modifier = {
			name = ee_spa_domination_of_line_infantry
			duration = -1
		}
		
	}
}

country_event = { #Most Notable Don Quixote of La Mancha
	id = ME_Castile_Events.66
	title = ME_Castile_Events.66.t
	desc = ME_Castile_Events.66.d
	picture = BATTLE_eventPicture

	trigger = {
		primary_culture = castillian
		2754 = {
			has_fort_building_trigger = yes
		}
		army_tradition = 75
	}
	fire_only_once = yes

	mean_time_to_happen = {
		months = 60
	}
	
	option = {
		name = ME_Castile_Events.66.a

		define_general = {
			shock = 6 #excellent horseman
			fire = 3 #ennobled
			manuever = 5
			siege = 3
			name = "Don Quixote de la Mancha"
			trait = ME_don_quixote_the_last_knight
		}
		if = {
			limit = {
				has_dlc = "Rights of Man"
			}
			custom_tooltip = CAS_special_trait_for_don_quixote
		} #I cant believe I am doing this
		
	}
}