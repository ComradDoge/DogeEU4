the_two_sicilies_missions_1 = {
	slot = 1
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = TTS
			AND = {
				OR = {
					tag = NAP
					tag = SIC
				}
				has_country_flag = TTS_without_tts
			}
			#tag = ITA
		}
		OR = {
			NOT = { has_dlc = "Emperor" }
			AND = {
				has_dlc = "Emperor"
				
			}
		}
	}

	tts_granary_kingdom = {
		icon = prosperity_for_all
		position = 11
		required_missions = { tts_dream_ruggero }
		trigger = {
			any_owned_province = {
				OR = {
					area = naples_area
					area = apulia_area
					area = calabria_area
					area = sicily_area
					area = western_sicily_area
				}
				OR = {
					trade_goods = grain
					trade_goods = wine
					trade_goods = livestock
					trade_goods = olive_oil
					trade_goods = cheese
					trade_goods = citrus
					trade_goods = potato
					trade_goods = tomato
				}
				base_production = 10
				has_manufactory_trigger = yes
				OR = {
					has_building = workshop
					has_building = counting_house
				}
			}
		}
		effect = {
			every_owned_province = {
				limit = {
					OR = {
						area = naples_area
						area = apulia_area
						area = calabria_area
						area = sicily_area
						area = western_sicily_area
					}
					trade_goods = livestock
				}
				add_permanent_province_modifier = {
					name = tts_transumanza
					duration = -1
				}
			}
			random_owned_province = {
				limit = {
					OR = {
						area = naples_area
						area = apulia_area
						area = calabria_area
						area = sicily_area
						area = western_sicily_area
					}					
					OR = {
						trade_goods = grain
						trade_goods = wine
						trade_goods = livestock
						trade_goods = olive_oil
						trade_goods = cheese
						trade_goods = citrus
						trade_goods = potato
						trade_goods = tomato
					}
				}
				if = {
					limit = {
						has_building = workshop
					}
					remove_building = workshop
					add_building_construction = {
						building = counting_house
						speed = 0.75
						cost = 0
					}
				}
				if = {
					limit = {
						has_manufactory_trigger = yes
					}
					add_base_production = 2
				}
			}
		}
	}

	tts_confronting_oppressors = {
		icon = the_hungarian_question
		position = 12
		required_missions = {
			tts_army_two_sicilies
		}
		trigger = {
			if = {
				limit = {
					exists = FRA
				}
				FRA = {
					NOT = {
						army_strength = {
							who = ROOT
							value = 1
						}
					}
				}
			}
			if = {
				limit = {
					exists = SPA
				}
				SPA = {
					NOT = {
						army_strength = {
							who = ROOT
							value = 1
						}
					}
				}
			}
			if = {
				limit = {
					exists = CAS
				}
				CAS = {
					NOT = {
						army_strength = {
							who = ROOT
							value = 1
						}
					}
				}
			}
			if = {
				limit = {
					exists = ARA
				}
				ARA = {
					NOT = {
						army_strength = {
							who = ROOT
							value = 1
						}
					}
				}
			}
			if = {
				limit = {
					exists = HAB
				}
				HAB = {
					NOT = {
						army_strength = {
							who = ROOT
							value = 1
						}
					}
				}
			}
		}
		effect = {
			if = {
				limit = {
					exists = FRA
				}
				add_casus_belli = {
					type = cb_italy_humiliation_rivals
					target = FRA
				}
			}
			if = {
				limit = {
					hre_size = 1
					emperor = {
						NOT = { tag = HAB }
					}
				}
				add_casus_belli = {
					type = cb_italy_humiliation_rivals
					target = emperor
				}
				if = {
					limit = {
						exists = HAB
					}
					add_casus_belli = {
						type = cb_italy_humiliation_rivals
						target = HAB
					}
				}
			}
			else_if = {
				limit = {
					exists = HAB
				}
				add_casus_belli = {
					type = cb_italy_humiliation_rivals
					target = HAB
				}
			}
			if = {
				limit = {
					exists = ARA
				}
				add_casus_belli = {
					type = cb_italy_humiliation_rivals
					target = ARA
				}
			}
			if = {
				limit = {
					exists = CAS
				}
				add_casus_belli = {
					type = cb_italy_humiliation_rivals
					target = CAS
				}
			}
			if = {
				limit = {
					exists = SPA
				}
				add_casus_belli = {
					type = cb_italy_humiliation_rivals
					target = SPA
				}
			}
		}
	}

	tts_end_oppressions = {
		icon = a_show_of_strength
		position = 13
		required_missions = {
			tts_confronting_oppressors
			tts_real_esercito
		}
		trigger = {
			if = {
				limit = {
					exists = FRA
				}
				OR = {
					has_won_war_against = {
						who = FRA
					}
					overlord_of = FRA
					total_development = FRA
				}
			}
			if = {
				limit = {
					exists = SPA
				}
				OR = {
					has_won_war_against = {
						who = SPA
					}
					overlord_of = SPA
					total_development = SPA
				}
			}
			if = {
				limit = {
					exists = CAS
				}
				OR = {
					has_won_war_against = {
						who = CAS
					}
					overlord_of = CAS
					total_development = CAS
				}
			}
			if = {
				limit = {
					exists = ARA
				}
				OR = {
					has_won_war_against = {
						who = ARA
					}
					overlord_of = ARA
					total_development = ARA
				}
			}
			if = {
				limit = {
					exists = HAB
				}
				OR = {
					has_won_war_against = {
						who = HAB
					}
					overlord_of = HAB
					total_development = HAB
				}
			}
		}
		effect = {
			add_adm_power = 100
			add_dip_power = 100
			add_mil_power = 100
			add_power_projection = {
				type = eclipsed_rival
				amount = 15
			}
		}
	}
}

the_two_sicilies_missions_2 = {
	slot = 2
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = TTS
			AND = {
				OR = {
					tag = NAP
					tag = SIC
				}
				has_country_flag = TTS_without_tts
			}
			#tag = ITA
		}
		OR = {
			NOT = { has_dlc = "Emperor" }
			AND = {
				has_dlc = "Emperor"
				
			}
		}
	}

	tts_army_two_sicilies = {
		icon = military_self_reliance
		position = 11
		required_missions = { tts_dream_ruggero }
		trigger = {
			army_size = 70
			manpower_percentage = 0.40
			num_of_owned_provinces_with = {
				value = 10
				OR = {
					area = naples_area
					area = apulia_area
					area = calabria_area
					area = sicily_area
					area = western_sicily_area
				}
				OR = {
					has_building = barracks
					has_building = training_fields
				}
				OR = {
					has_building = regimental_camp
					has_building = conscription_center
				}
			}
		}
		effect = {
			add_yearly_manpower = 2
			add_country_modifier = {
				name = tts_army_preparation
				duration = 730
			}
			random_owned_province = {
				limit = {
					OR = {
						area = naples_area
						area = apulia_area
						area = calabria_area
						area = sicily_area
						area = western_sicily_area
					}
				}
				if = {
					limit = {
						has_building = barracks
					}
					remove_building = barracks
					add_building_construction = {
						building = training_fields
						speed = 0.75
						cost = 0
					}
				}
				if = {
					limit = {
						has_building = regimental_camp
					}
					remove_building = regimental_camp
					add_building_construction = {
						building = conscription_center
						speed = 0.75
						cost = 0
					}
				}
			}
		}
	}

	tts_real_esercito = {
		icon = professional_army
		position = 11
		required_missions = { tts_army_two_sicilies }
		trigger = {
			121 = { base_manpower = 15 }
			125 = {	base_manpower = 15 }
			OR = {
				has_mil_advisor_3 = yes
				MIL = 6
			}
		}
		effect = {
			country_event = {
				id = ME_The_Two_Sicilies_Events.3
			}
			121 = {
				add_permanent_province_modifier = {
					name = tts_nunziatella
				}
			}
		}
	}
}

the_two_sicilies_missions_3 = {
	slot = 3
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = TTS
			AND = {
				OR = {
					tag = NAP
					tag = SIC
				}
				has_country_flag = TTS_without_tts
			}
			#tag = ITA
		}
		OR = {
			NOT = { has_dlc = "Emperor" }
			AND = {
				has_dlc = "Emperor"
				
			}
		}
	}

	tts_dream_ruggero = {
		icon = king_of_sicily
		position = 10
		required_missions = { 
			nap_sicilian_union
			sic_sicilian_union
		}
		provinces_to_highlight = {
			OR = {
				area = apulia_area
				area = calabria_area
				area = western_sicily_area
				area = sicily_area
				area = naples_area
			}
			OR = {
				NOT = { country_or_non_sovereign_subject_holds = ROOT }
			}
		}
		trigger = {
			stability = 2
			legitimacy_equivalent = 90
			apulia_area = {
				type = all
				if = {
					limit = {
						has_dlc = "Mandate of Heaven"
					}
					prosperity = 50
				}
				else = {
					devastation = 0
				}
			}
			calabria_area = {
				type = all
				if = {
					limit = {
						has_dlc = "Mandate of Heaven"
					}
					prosperity = 50
				}
				else = {
					devastation = 0
				}
			}
			western_sicily_area = {
				type = all
				if = {
					limit = {
						has_dlc = "Mandate of Heaven"
					}
					prosperity = 50
				}
				else = {
					devastation = 0
				}
			}
			sicily_area = {
				type = all
				if = {
					limit = {
						has_dlc = "Mandate of Heaven"
					}
					prosperity = 50
				}
				else = {
					devastation = 0
				}
			}
			naples_area = {
				type = all
				if = {
					limit = {
						has_dlc = "Mandate of Heaven"
					}
					prosperity = 50
				}
				else = {
					devastation = 0
				}
			}
		}
		effect = {
			add_country_modifier = {
				name = tts_norman_sicilia
				duration = -1
			}
			if = {
				limit = {
					OR = {
						overlord_of = SIC
						overlord_of = NAP
					}
				}
				country_event = {
					id = ME_The_Two_Sicilies_Events.2
				}
			}
		}
	}

	tts_conquest_of_rome = {
		icon = sway_the_pope
		position = 13
		required_missions = {
			tts_real_esercito
			tts_dream_ruggero
			tts_real_marina
		}
		trigger = {
			NOT = {
				any_country = {
					culture_group = latin
					capital_scope = {
						region = italy_region
					}
					army_strength = {
						who = ROOT
						value = 1
					}
				}
			}
		}
		effect = {
			118 = { add_core = ROOT }
		}
	}
}

the_two_sicilies_missions_4 = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = TTS
			AND = {
				OR = {
					tag = NAP
					tag = SIC
				}
				has_country_flag = TTS_without_tts
			}
			#tag = ITA
		}
		OR = {
			NOT = { has_dlc = "Emperor" }
			AND = {
				has_dlc = "Emperor"
				
			}
		}
	}

	tts_army_sea = {
		icon = overshadow_venice
		position = 11
		required_missions = { tts_dream_ruggero }
		trigger = {
			navy_size = 120
			sailors = 8500
			num_of_owned_provinces_with = {
				value = 10
				OR = {
					area = naples_area
					area = apulia_area
					area = calabria_area
					area = sicily_area
					area = western_sicily_area
				}
				OR = {
					has_building = dock
					has_building = drydock
				}
				OR = {
					has_building = shipyard
					has_building = grand_shipyard
				}
			}
		}
		effect = {
			add_yearly_sailors = 2
			add_country_modifier = {
				name = tts_naval_preparation
				duration = 5475
			}
			random_owned_province = {
				limit = {
					OR = {
						area = naples_area
						area = apulia_area
						area = calabria_area
						area = sicily_area
						area = western_sicily_area
					}
				}
				if = {
					limit = {
						has_building = dock
					}
					remove_building = dock
					add_building_construction = {
						building = drydock
						speed = 0.75
						cost = 0
					}
				}
				if = {
					limit = {
						has_building = shipyard
					}
					remove_building = shipyard
					add_building_construction = {
						building = grand_shipyard
						speed = 0.75
						cost = 0
					}
				}
			}
		}
	}

	tts_real_marina = {
		icon = mission_aragonese_navy
		position = 12
		required_missions = { tts_army_sea }
		trigger = {
			navy_size_percentage = 1
			any_country = {
				341 = {
					trade_share = {
						share = 1
						country = PREV
					}
				}
				NOT = { navy_size = ROOT }
			}
			any_country = {
				1298 = {
					trade_share = {
						share = 1
						country = PREV
					}
				}
				NOT = { navy_size = ROOT }
			}
			any_country = {
				1308 = {
					trade_share = {
						share = 1
						country = PREV
					}
				}
				NOT = { navy_size = ROOT }
			}
			any_country = {
				1320 = {
					trade_share = {
						share = 1
						country = PREV
					}
				}
				NOT = { navy_size = ROOT }
			}
			any_country = {
				358 = {
					trade_share = {
						share = 1
						country = PREV
					}
				}
				NOT = { navy_size = ROOT }
			}
		}
		effect = {
			add_country_modifier = {
				name = tts_marine_infrantry_corps
				duration = -1
			}
			125 = {
				add_permanent_province_modifier = {
					name = tts_real_marina
				}
			}
		}
	}
}

the_two_sicilies_missions_5 = {
	slot = 5
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		OR = {
			tag = TTS
			AND = {
				OR = {
					tag = NAP
					tag = SIC
				}
				has_country_flag = TTS_without_tts
			}
			#tag = ITA
		}
		OR = {
			NOT = { has_dlc = "Emperor" }
			AND = {
				has_dlc = "Emperor"
				
			}
		}
	}

	tts_tonnare_siciliane = {
		icon = develop_the_po_valley
		position = 11
		required_missions = { tts_dream_ruggero }
		trigger = {
			any_owned_province = {
				OR = {
					area = naples_area
					area = apulia_area
					area = calabria_area
					area = sicily_area
					area = western_sicily_area
				}
				trade_goods = fish
				base_production = 10
				has_manufactory_trigger = yes
				OR = {
					has_building = workshop
					has_building = counting_house
				}
			}
		}
		effect = {
			every_owned_province = {
				limit = {
					OR = {
						area = naples_area
						area = apulia_area
						area = calabria_area
						area = sicily_area
						area = western_sicily_area
					}
					trade_goods = fish
				}
				add_permanent_province_modifier = {
					name = tts_tonnara_siciliana
					duration = -1
				}
			}
		}
	}

	tts_protecting_sea_zones = {
		icon = mission_disrupt_portuguese_trade
		position = 12
		required_missions = { tts_army_sea }
		trigger = {
			NOT = {
				any_country = {
					home_trade_node = {
						privateer_power = {
							share = 10
						}
					}
				}
			}
			if = {
				limit = {
					any_country = {
						culture_group = maghrebi
					}
				}
				NOT = {
					any_country = {
						culture_group = maghrebi
						naval_strength = {
							who = ROOT
							value = 1
						}
					}
				}
			}
			if = {
				limit = {
					exists = MAM
				}
				MAM = {
					NOT = {
						naval_strength = {
							who = ROOT
							value = 1
						}
					}
				}
			}
			if = {
				limit = {
					exists = TUR
				}
				TUR = {
					NOT = {
						naval_strength = {
							who = ROOT
							value = 1
						}
					}
				}
			}
		}
		effect = {
			add_navy_tradition = 15
			if = {
				limit = {
					exists = MAM
				}
				add_casus_belli = {
					type = cb_crusade
					target = MAM
				}
			}
			if = {
				limit = {
					exists = TUR
				}
				add_casus_belli = {
					type = cb_crusade
					target = TUR
				}
			}
		}
	}
}